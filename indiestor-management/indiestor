#!/usr/bin/php
<?php
/*
        Indiestor program

	Written by Erik Poupaert, erik@sankuru.biz
        Commissioned at peopleperhour.com 
        By Alex Gardiner, alex.gardiner@canterbury.ac.uk
*/

<<<<<<< HEAD
=======
//check that the user is root
$processUser = posix_getpwuid(posix_geteuid());
$processUserName=$processUser['name'];
if($processUserName!='root')
{
	die("Only root can run this program\n");
}

//check that shell_exec is allowed
if(false !== strpos(ini_get('disable_functions'), 'shell_exec'))
{
	die("The shell_exec() is has been disabled in php.ini. You cannot run this program without it.\n");
}

//check that the quota commands are installed
$quotaCommands=array('quota','quotaon','quotacheck','quotaoff','setquota');
$quotaInstalled=true; //assume the quota package has properly been installed
foreach($quotaCommands as $quotaCommand)
{
	$location=trim(shell_exec("which $quotaCommand"));
	if(strlen($location)==0) 
	{
		echo "'$quotaCommand' command not installed\n";
		$quotaInstalled=false;
	}
}
if(!$quotaInstalled) die("The quota package does not seem to be installed properly.\n".
		" Use apt-get quota to install it first.\n");

require_once('lib/require_once_folder.php');
>>>>>>> fixes to error messages; reorganized indiestor subfolders
require_once('lib/args/ProgramActions.php');
require_once('lib/args/ProgramOptions.php');
require_once('lib/ArgEngine.php');
require_once('lib/ActionEngine.php');
require_once('lib/syscommands/ShellCommand.php');
require_once('lib/sysqueries/ShellQuery.php');

$argEngine=new ArgEngine($argv);
$argEngine->process();

ProgramOptions::extractFromProgramActions();

<<<<<<< HEAD

//check that the user is root
$processUser = posix_getpwuid(posix_geteuid());
$processUserName=$processUser['name'];
if($processUserName!='root')
{
	die("Only root can run this program");
}

=======
>>>>>>> fixes to error messages; reorganized indiestor subfolders
ActionEngine::execute();

